var Workout4aJSON = [
    ["","BLOCK 1","VOLUME","","","","","",null,"","","","","",null,"","","","","",null,"","",""  ],
    ["","LEVELS 16-25","","","","","","",null,"","","","","",null,"","","","","",null,"","",""  ],
    ["","Week 1","","","","","","",null,"","","","","",null,"","","","","",null,"","",""  ],
    ["","Day 1","","R","RPE","Strength Drop","","Day 2",null,"R","RPE","Strength Drop","","Day 3",null,"R","RPE","Strength Drop","","Day 4",null,"R","RPE","Strength Drop"  ],
    ["","Squat","","6","8","5%","","UB Hor Push",null,"8","7","7%","","Hinge",null,"6","8","5%","","UB Vert Push",null,"8","7","7%"  ],
    ["","Hinge","-1","4 x 8","8-8.5","","","UB Vert Pull",null,"#","7","Stop: 8.5","","LB Uni Push",null,"6","8","5%","","UB Hor Pull",null,"10","7","7%"  ],
    ["","LB Uni Push","-1","3 x 8","7.5","","","UB Hor Pull",-1,"4 x 10","7","","","Squat",-1,"3 x 8","7.5","","","UB Hor Push",-1,"3 x 10","7",""  ],
    ["","Carry ","","3 x :60","","","","Iso 1",null,"3 x 12","7","","","Carry",-1,"3 x :60","","","","Iso 2",null,"3 x 12","7",""  ],
    ["","Ant Chain","","3 x #","7.5","","","Iso 3",null,"3 x 12","7","","","Post Chain",null,"3 x #","7.5","","","Iso 4",null,"3 x 12","7",""  ],
    ["","","","","","","","",null,"","","","","",null,"","","","","",null,"","",""  ],
    ["","Week 2","","","","","","",null,"","","","","",null,"","","","","",null,"","",""  ],
    ["","Day 1","","R","RPE","Strength Drop","","Day 2",null,"R","RPE","Strength Drop","","Day 3",null,"R","RPE","Strength Drop","","Day 4",null,"R","RPE","Strength Drop"  ],
    ["","Squat","","8","7","7%","","UB Hor Push",null,"6","8","5%","","Hinge",null,"8","7","7%","","UB Vert Push",null,"6","8","5%"  ],
    ["","Hinge","-1","4 x 10","7","","","UB Vert Pull",null,"#","8","Stop: 8.5","","LB Uni Push",null,"8","7","7%","","UB Hor Pull",null,"8","8","5%"  ],
    ["","LB Uni Push","-1","3 x 10","7","","","UB Hor Pull",-1,"3x10","7.5","","","Squat",-1,"3 x10","7","","","UB Hor Push",-1,"3 x 8","7.5",""  ],
    ["","Iso 1","","3 x 10","7","","","Carry ",null,"3 x :45","","","","Iso 2",null,"3 x 10","7","","","Carry",-1,"3 x :45","",""  ],
    ["","Iso 3","","3 x 10","7","","","Ant Chain",null,"3x #","7.5","","","Iso 4",null,"3 x 10","7","","","Post Chain",null,"3 x #","7",""  ],
    ["","","","","","","","",null,"","","","","",null,"","","","","",null,"","",""  ],
    ["","","","","","","","",null,"","","","","",null,"","","","","",null,"","",""  ],
    ["","Week 3","","","","","","",null,"","","","","",null,"","","","","",null,"","",""  ],
    ["","Day 1","","R","RPE","Strength Drop","","Day 2",null,"R","RPE","Strength Drop","","Day 3",null,"R","RPE","Strength Drop","","Day 4",null,"R","RPE","Strength Drop"  ],
    ["","Squat","","6","9","10%","","UB Hor Push",null,"8","7","7%","","Hinge",null,"6","9","10%","","UB Vert Push",null,"8","7","7%"  ],
    ["","Hinge","-1","4 x 6","8-9","","","UB Vert Pull",null,"#","7","Stop: 8.5","","LB Uni Push",null,"6","9","10%","","UB Hor Pull",null,"10","7","7%"  ],
    ["","LB Uni Push","-1","3 x 8","8","","","UB Hor Pull",-1,"4 x 10","7","","","Squat",-1,"3 x 8","8","","","UB Hor Push",-1,"3 x 10","7",""  ],
    ["","Carry ","3 x 40yds","","","","","Iso 1",null,"3 x 12","7","","","Carry",-1,"3 x 40yds","","","","Iso 2",null,"3 x 12","7",""  ],
    ["","Ant Chain","","3 x #","8","","","Iso 3",null,"3 x 12","7","","","Post Chain",null,"3 x #","8","","","Iso 4",null,"3 x 12","7",""  ],
    ["","","","","","","","",null,"","","","","",null,"","","","","",null,"","",""  ],
    ["","Week 4","Deload","","","","","",null,"","","","","",null,"","","","","",null,"","",""  ],
    ["","Day 1","","R","RPE","Strength Stop","","Day 2",null,"R","RPE","Strength Drop","","Day 3",null,"R","RPE","Strength Stop","","Day 4",null,"R","RPE","Strength Drop"  ],
    ["","Squat","-2","15","5","6","","UB Hor Push",null,"6","9","10%","","Hinge",-2,"15","5","6","","UB Vert Push",null,"6","9","10%"  ],
    ["","Hinge","-2","15","4-5","","","UB Vert Pull",null,"3 x #","8","","","LB Uni Push",-2,"15","5","6","","UB Hor Pull",null,"3 x 8","8",""  ],
    ["","LB Uni Push","-2","2 x 15","4-5","","","UB Hor Pull",-2,"2 x15","4-5","","","Squat",-2,"2 x 15","4-5","","","UB Hor Push",-2,"2 x 15","4-5",""  ],
    ["","Carry","","2 x :60","","","","Iso 1",null,"2 x 15","4-5","","","Carry",-1,"2 x :45","","","","Iso 2",null,"2 x 15","4-5",""  ],
    ["","Ant Chain","","2 x #","4-5","","","Iso 3",null,"2 x 15","4-5","","","Post Chain",null,"2 x #","4-5","","","Iso 4",null,"2 x 15","4-5",""  ]
]

var Workouts4a = {
    Templates: {
        1: {},
        2: {},
        3: {},
        4: {},
        // 5: {}
    },
    getWeekDay: {},
    getID: {}
}

var TemplateNum = 0;
for (var W = 1; W <= 4; W++) {
  for (var D = 1; D <= 4; D++) {
      TemplateNum ++;
      if (!(W in Workouts4a.getID)) {
        Workouts4a.getID[W] = {}
        Workouts4a.getID[W][D] = TemplateNum;
      }
      else {
        Workouts4a.getID[W][D] = TemplateNum;
      }
      Workouts4a.Templates[W][D] = {
          ID: TemplateNum,
          Week: W,
          Day: D,
          NPatterns: 0,
          Patterns: {}
      }
      Workouts4a.getWeekDay[TemplateNum] = {Week: W, Day: D};
  }
}
// for (var D = 1; D <= 3; D++) {
//     TemplateNum ++;
//     if (!(5 in Workouts3b.getID)) {
//         Workouts3b.getID[5] = {}
//         Workouts3b.getID[5][D] = TemplateNum;
//     }
//     else {
//       Workouts3b.getID[5][D] = TemplateNum;
//     }
//     Workouts3b.Templates[5][D] = {
//         ID: TemplateNum,
//         Week: 5,
//         Day: D,
//         NPatterns: 0,
//         Patterns: {}
//     }
//     Workouts3b.getWeekDay[TemplateNum] = {Week: 5, Day: D};  
// }

module.exports = Workouts4a;


var thisWeek = 0;
var thisDay = 0;
var thisSpecial = "";
var specialsList = ["", "", "", ""];


Workout4aJSON.forEach(elem => {
    var AllDays = [
        elem.slice(1, 7),
        elem.slice(7, 13),
        elem.slice(13, 19),
        elem.slice(19),    
    ]
    if (AllDays[0][0].includes("Week")) {
        thisWeek = parseInt(AllDays[0][0].split(" ")[1].trim());
        console.log("thisWeek(1): " + thisWeek);
    }

    for (var i = 0; i < AllDays.length; i ++) {
        if (thisWeek == 0) {
            continue;
        }
        var dayRow = AllDays[i];
        var dayNum = i + 1;
        thisDay = dayNum;
        if (dayRow[0].includes("Day")) {
            // console.log("Workout Template: " + " Week, Day: ", thisWeek, thisDay);
            if (dayRow[4] != "") {
                if (dayRow[4].includes("Stop")) {
                    thisSpecial = "Strength Stop";
                    specialsList[dayNum - 1] = "Strength Stop";
                }
                else if (dayRow[4].includes("Drop")) {
                    thisSpecial = "Strength Drop";
                    specialsList[dayNum - 1] = "Strength Drop";                    
                }
                else if (dayRow[4].includes("A")) {
                    thisSpecial = "Alloy";
                    specialsList[dayNum - 1] = "Alloy";
                }
                console.log("   Special Type: " + thisSpecial);
            }
            // console.log(Workouts3b.Templates[thisWeek][thisDay]);
        }        
        if (AllDays[0][0].includes("Week") || AllDays[0][0].includes("Day") || dayRow[0] == "") {
            // continue;
        }
        else {
            console.log("thisWeek", thisWeek);
            console.log("thisDay", thisDay);
            Workouts4a.Templates[thisWeek][thisDay].NPatterns ++;
            var PatternNum = Workouts4a.Templates[thisWeek][thisDay].NPatterns;
            var PatternDict = {
                ExerciseType: dayRow[0].trim(),
                Reps: dayRow[2],                
            };
            //     if (item[0] != "") {
            var refDict = {};
            refDict["EType"] = dayRow[0];
            refDict["Deload"] = dayRow[1];
            refDict["SxR"] = dayRow[2];
            refDict["RPE"] = dayRow[3];
            refDict["Special"] = dayRow[4];

            // SETS AND REPS
            if (refDict["SxR"].includes("x") || refDict["SxR"].includes("X")) {
                var splitChar = "x";
                var Sets = parseInt(refDict["SxR"].trim().split(splitChar)[0]);    
                var Reps = refDict["SxR"].trim().split(splitChar)[1];
                PatternDict.Sets = Sets;
                PatternDict.Reps = parseInt(Reps.trim());
                // SETS AND REPS
                if (PatternDict.ExerciseType == "Carry") {
                    if (Reps.includes(":")) {
                        PatternDict.Reps = parseInt(Reps.trim().slice(1));
                        PatternDict.Seconds = PatternDict.Reps;
                    }
                    else {
                        PatternDict.Reps = parseInt(Reps.trim());
                        PatternDict.Seconds = PatternDict.Reps;                        
                    }
                    PatternDict.Type = "carry";
                }
                else if (Reps.includes("#")) {
                    PatternDict.Reps = "Bodyweight";             
                    PatternDict.Type = "bodyweight";       
                }
            }
            // STAGGERED REPS
            else if (refDict["SxR"].includes(",")) {
                var repSplit = refDict["SxR"].trim().split(",");
                var repList = [];
                var setCount = 0;
                repSplit.forEach((reps) => {
                    if (reps != "#") {
                        repList.push(parseInt(reps));
                        setCount ++;                        
                    }
                })
                PatternDict.Reps = repList;
                PatternDict.Sets = setCount;
                PatternDict.SplitSets = true;
            }
            else {
                PatternDict.Sets = 1;
            }
            //DELOAD
            if (refDict["Deload"] != "" && refDict["Deload"] != null) {
                PatternDict.Deload = parseInt(refDict["Deload"]);
            }
            // RPE
            if (refDict["RPE"] != "" && refDict["RPE"] != null) {
                if (refDict["RPE"].includes("-")) {
                    PatternDict.RPE = refDict["RPE"];
                }
                else {
                    PatternDict.RPE = parseFloat(refDict["RPE"]);
                }
            }
                
            //Special Val
            if (refDict["Special"] != "") {

                if (specialsList[dayNum - 1] == "Strength Stop") {
                    PatternDict.Type = "stop";
                    PatternDict.StopRPE = parseFloat(refDict["Special"]);
                }
                else if (specialsList[dayNum - 1] == "Strength Drop"
                || specialsList[dayNum - 1].includes("Drop")) {
                    PatternDict.Type = "drop";
                    PatternDict.DropValue = parseFloat(refDict["Special"]);
                }
                else if (specialsList[dayNum - 1] == "Alloy") {
                    PatternDict.Alloy = true;
                    PatternDict.AlloyReps = parseInt(refDict["Special"]);
                }
                PatternDict.Special = specialsList[dayNum - 1];
            }
            Workouts4a.Templates[thisWeek][thisDay].Patterns[PatternNum] = PatternDict;

            //       thisTemplate.Patterns[thisTemplate.NPatterns] = PatternDict;

            //       // 1: {ExerciseType: "UB Hor Push", Reps: 8, RPE: 7, Type: "drop", DropValue: 7,},
            //       // 1: {ExerciseType: "UB Hor Push", Reps: 8, RPE: 7, Type: "drop", DropValue: 7,},
            //       // 2: {ExerciseType: "UB Vert Pull", Reps: 7, RPE: 7, Type: "stop", StopRPE: 8.5,},
            //       // 3: {ExerciseType: "UB Hor Pull",  Sets: 4, Reps: 10, RPE: 7, Deload: -1},
            //       // 4: {ExerciseType: "Iso 1",  Sets: 3, Type: "bodyweight", Reps: 12, RPE: 7},
            //       // 5: {ExerciseType: "Iso 3",  Sets: 3, Type: "carry", Reps: 12, RPE: 7},
            //       // 1: {ExerciseType: "Hinge", Sets: 3, Reps: 10, RPE: 7,},

            //       // ["W1D4","Ant Chain","","2 x #","4-5",""  ]
            //       // console.log(item, week, day);
            //       // console.log(84, Workouts3a.Templates[week][day]);
            //         //Assign to workout object here

            // console.log("   Pattern Detected: " + dayRow[0]);            
        }
    }


    AllDays.forEach(day => {

    })


    var D1List = elem.slice(1, 7);
    var D2List = elem.slice(7, 13);
    var D3List = elem.slice(13, 19);
    var D4List = elem.slice(19);
    
    // console.log(elem[1], elem[7], elem[13]);
    // console.log("Day 1: " + elem.slice(1, 7));
    // console.log("Day 2: " +  elem.slice(7, 13));
    // console.log("Day 3: " +  elem.slice(13, 19));
    // console.log("Day 4: " + elem.slice(19))
    // console.log(elem.slice(7));
})
